USE_OCAMLFIND = true

MENHIR_ENABLED = true
MENHIR_FLAGS += --infer

NATIVE_ENABLED = true
BYTE_ENABLED = true

OCAMLPACKS[] =
    batteries

OCAMLINCLUDES[] =
    ../poly
    ../constraints

OCAML_LIBS[] =
    ../poly/poly
    ../constraints/constraints

GEN_FILES_1[] =
    PolynomialParser.ml
    PolynomialParser.mli
    PolynomialLexer.ml

GEN_FILES_2[] =
    PolynomialConstraintsAtomParser.ml
    PolynomialConstraintsAtomParser.mli
    PolynomialConstraintsAtomLexer.ml

OCamlGeneratedFiles($(GEN_FILES_1))
OCamlGeneratedFiles($(GEN_FILES_2))

FILES_1[] =
    PolynomialParser
    PolynomialLexer

FILES_2[] =
    PolynomialConstraintsAtomParser
    PolynomialConstraintsAtomLexer

LIB_1 = poly_parser
LIB_2 = poly_constraint_parser

OCamlLibrary($(LIB_1), $(FILES_1))
OCamlLibrary($(LIB_2), $(FILES_2))

clean:
  rm -f \
     *.omc \
     $(filter-proper-targets $(glob $(addsuffix .*, $(FILES_1)))) \
     $(filter-proper-targets $(glob $(addsuffix .*, $(FILES_2)))) \
     $(LIB_1).a $(LIB_1).cmxa $(LIB_1).cma \
     $(LIB_2).a $(LIB_2).cmxa $(LIB_2).cma \
     $(GEN_FILES_1) \
     $(GEN_FILES_2) \
     *~
